{
  "version": 3,
  "sources": ["../../../../node_modules/.pnpm/@douyinfe+semi-foundation@2.34.0/node_modules/@douyinfe/semi-foundation/lib/es/rating/foundation.js"],
  "sourcesContent": ["/* eslint-disable no-param-reassign */\nimport BaseFoundation from '../base/foundation';\nimport warning from '../utils/warning';\nexport default class RatingFoundation extends BaseFoundation {\n  constructor(adapter) {\n    super(Object.assign(Object.assign({}, RatingFoundation.defaultAdapter), adapter));\n\n    this.handleStarFocusVisible = event => {\n      const {\n        target\n      } = event;\n      const {\n        count\n      } = this.getProps(); // when rating 0 is focus visible\n\n      try {\n        if (target.matches(':focus-visible')) {\n          this._adapter.setEmptyStarFocusVisible(true);\n        }\n      } catch (error) {\n        warning(true, 'Warning: [Semi Rating] The current browser does not support the focus-visible');\n      }\n    }; // e: FocusEvent\n\n\n    this.handleStarBlur = e => {\n      const {\n        emptyStarFocusVisible\n      } = this.getStates();\n\n      if (emptyStarFocusVisible) {\n        this._adapter.setEmptyStarFocusVisible(false);\n      }\n    };\n  }\n\n  init() {\n    const {\n      autoFocus,\n      disabled\n    } = this.getProps();\n\n    if (autoFocus && !disabled) {\n      this._adapter.focus();\n    }\n  }\n\n  _getScroll(w, top) {\n    let ret = top ? w.pageYOffset : w.pageXOffset;\n    const method = top ? 'scrollTop' : 'scrollLeft';\n\n    if (typeof ret !== 'number') {\n      const d = w.document; // ie6,7,8 standard mode\n\n      ret = d.documentElement[method];\n\n      if (typeof ret !== 'number') {\n        // quirks mode\n        ret = d.body[method];\n      }\n    }\n\n    return ret;\n  }\n\n  _getClientPosition(elem) {\n    let x, y;\n    const doc = elem.ownerDocument;\n    const {\n      body\n    } = doc;\n    const docElem = doc && doc.documentElement;\n    const box = elem.getBoundingClientRect();\n    x = box.left;\n    y = box.top;\n    x -= docElem.clientLeft || body.clientLeft || 0;\n    y -= docElem.clientTop || body.clientTop || 0;\n    return {\n      left: x,\n      top: y\n    };\n  }\n\n  _getOffsetLeft(el) {\n    const pos = this._getClientPosition(el);\n\n    const doc = el.ownerDocument;\n    const w = doc.defaultView || doc.parentWindow;\n    pos.left += this._getScroll(w);\n    return pos.left;\n  }\n\n  getStarValue(index, pos) {\n    const {\n      allowHalf\n    } = this.getProps();\n\n    const direction = this._adapter.getContext('direction');\n\n    const reverse = direction === 'rtl';\n    let value = index + 1;\n\n    if (allowHalf) {\n      const starEle = this._adapter.getStarDOM(index);\n\n      const leftDis = this._getOffsetLeft(starEle);\n\n      const width = starEle.clientWidth;\n\n      if (reverse && pos - leftDis > width / 2) {\n        value -= 0.5;\n      } else if (!reverse && pos - leftDis < width / 2) {\n        value -= 0.5;\n      }\n    }\n\n    return value;\n  }\n\n  handleHover(event, index) {\n    const currValue = this.getStarValue(index, event.pageX);\n    const {\n      clearedValue,\n      hoverValue\n    } = this.getStates();\n\n    if (currValue !== hoverValue && currValue !== clearedValue) {\n      this._adapter.notifyHoverChange(currValue, null);\n    }\n  }\n\n  handleMouseLeave() {\n    this._adapter.notifyHoverChange(undefined, null);\n  }\n\n  handleClick(event, index) {\n    const {\n      allowClear\n    } = this.getProps();\n    const {\n      value\n    } = this.getStates();\n    const newValue = this.getStarValue(index, event.pageX);\n    const isReset = allowClear ? newValue === value : false;\n\n    this._adapter.updateValue(isReset ? 0 : newValue);\n\n    if (isReset) {\n      this._adapter.notifyHoverChange(undefined, newValue);\n    } else {\n      this._adapter.clearValue(null);\n    }\n  }\n\n  handleFocus(e) {\n    this._adapter.notifyFocus(e);\n  }\n\n  handleBlur(e) {\n    this._adapter.notifyBlur(e);\n  }\n\n  handleKeyDown(event, value) {\n    const {\n      key\n    } = event;\n    const {\n      count,\n      allowHalf\n    } = this.getProps();\n\n    const direction = this._adapter.getContext('direction');\n\n    const reverse = direction === 'rtl';\n    const step = allowHalf ? 0.5 : 1;\n    let tempValue;\n    let newValue;\n\n    if (key === 'ArrowRight' || key === 'ArrowUp') {\n      tempValue = value + (reverse ? -step : step);\n    } else if (key === 'ArrowLeft' || key === 'ArrowDown') {\n      tempValue = value + (reverse ? step : -step);\n    }\n\n    if (tempValue > count) {\n      newValue = 0;\n    } else if (tempValue < 0) {\n      newValue = count;\n    } else {\n      newValue = tempValue;\n    }\n\n    if (['ArrowRight', 'ArrowUp', 'ArrowLeft', 'ArrowDown'].includes(key)) {\n      this._adapter.notifyKeyDown(event);\n\n      this._adapter.updateValue(newValue);\n\n      this.changeFocusStar(newValue, event);\n      event.preventDefault();\n\n      this._adapter.notifyHoverChange(undefined, null);\n    }\n  }\n\n  changeFocusStar(value, event) {\n    const {\n      count,\n      allowHalf,\n      preventScroll\n    } = this.getProps();\n    const index = Math.ceil(value) - 1;\n    const starElement = [...event.currentTarget.childNodes].map(item => item.childNodes[0].childNodes);\n\n    if (index < 0) {\n      starElement[count][0].focus({\n        preventScroll\n      });\n    } else {\n      starElement[index][allowHalf ? value * 10 % 10 === 5 ? 0 : 1 : 0].focus({\n        preventScroll\n      });\n    }\n  }\n\n}\nexport class RatingItemFoundation extends BaseFoundation {\n  constructor(adapter) {\n    super(Object.assign(Object.assign({}, RatingItemFoundation.defaultAdapter), adapter));\n\n    this.handleFocusVisible = (event, star) => {\n      const {\n        target\n      } = event; // when rating 0 is focus visible\n\n      try {\n        if (target.matches(':focus-visible')) {\n          if (star === 'first') {\n            this._adapter.setFirstStarFocus(true);\n          } else {\n            this._adapter.setSecondStarFocus(true);\n          }\n        }\n      } catch (error) {\n        warning(true, 'Warning: [Semi Rating] The current browser does not support the focus-visible');\n      }\n    }; // e: FocusEvent\n\n\n    this.handleBlur = (e, star) => {\n      const {\n        firstStarFocus,\n        secondStarFocus\n      } = this.getStates();\n\n      if (star === 'first') {\n        firstStarFocus && this._adapter.setFirstStarFocus(false);\n      } else {\n        secondStarFocus && this._adapter.setSecondStarFocus(false);\n      }\n    };\n  }\n\n}"],
  "mappings": "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",
  "names": []
}
