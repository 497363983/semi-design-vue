{
  "version": 3,
  "sources": ["../../../../node_modules/.pnpm/@douyinfe+semi-foundation@2.34.0/node_modules/@douyinfe/semi-foundation/lib/es/input/foundation.js"],
  "sourcesContent": ["import _isFunction from \"lodash/isFunction\";\nimport _isString from \"lodash/isString\";\nimport _isNumber from \"lodash/isNumber\";\nimport _set from \"lodash/set\";\nimport _noop from \"lodash/noop\";\nimport BaseFoundation from '../base/foundation';\nimport { strings } from './constants';\nimport { ENTER_KEY } from './../utils/keyCode';\n\nclass InputFoundation extends BaseFoundation {\n  constructor(adapter) {\n    super(Object.assign(Object.assign({}, InputFoundation.inputDefaultAdapter), adapter));\n  }\n\n  static get inputDefaultAdapter() {\n    return {\n      notifyChange: _noop,\n      setValue: _noop // toggleAllowClear: noop,\n\n    };\n  }\n\n  init() {\n    this._setInitValue();\n  }\n\n  destroy() {\n    if (this._timer) {\n      clearTimeout(this._timer);\n      this._timer = null;\n    }\n  } // eslint-disable-next-line\n\n\n  setDisable() {}\n\n  _setInitValue() {\n    const {\n      defaultValue,\n      value\n    } = this.getProps();\n    let v = defaultValue;\n\n    if (this._isControlledComponent()) {\n      v = value;\n    }\n\n    this._adapter.setValue(v); // this.checkAllowClear(v);\n\n  }\n\n  setValue(value) {\n    this._adapter.setValue(value);\n  }\n\n  handleChange(value, e) {\n    const {\n      maxLength,\n      minLength,\n      getValueLength\n    } = this._adapter.getProps();\n\n    let nextValue = value;\n\n    if (maxLength && _isFunction(getValueLength)) {\n      nextValue = this.handleVisibleMaxLength(value);\n    }\n\n    if (minLength && _isFunction(getValueLength)) {\n      this.handleVisibleMinLength(nextValue);\n    }\n\n    if (this._isControlledComponent()) {\n      /**\n       * If it is a controlled component, directly notify the caller of the modified value.\n       * Truncate the input value from the input box if the input value exceeds the maximum length limit.\n       *  Even in controlled components, characters that exceed the length limit cannot be entered through the input box.\n       */\n      this._adapter.notifyChange(nextValue, e);\n    } else {\n      this._adapter.setValue(nextValue);\n\n      this._adapter.notifyChange(nextValue, e); // this.checkAllowClear(value);\n\n    }\n  }\n  /**\n   * Modify minLength to trigger browser check for minimum length\n   * Controlled mode is not checked\n   * @param {String} value\n   */\n\n\n  handleVisibleMinLength(value) {\n    const {\n      minLength,\n      getValueLength\n    } = this._adapter.getProps();\n\n    const {\n      minLength: stateMinLength\n    } = this._adapter.getStates();\n\n    if (_isNumber(minLength) && minLength >= 0 && _isFunction(getValueLength) && _isString(value)) {\n      const valueLength = getValueLength(value);\n\n      if (valueLength < minLength) {\n        const newMinLength = value.length + (minLength - valueLength);\n        newMinLength !== stateMinLength && this._adapter.setMinLength(newMinLength);\n      } else {\n        stateMinLength !== minLength && this._adapter.setMinLength(minLength);\n      }\n    }\n  }\n  /**\n   * Handle input emoji characters beyond maxLength\n   * Controlled mode is not checked\n   * @param {String} value\n   */\n\n\n  handleVisibleMaxLength(value) {\n    const {\n      maxLength,\n      getValueLength\n    } = this._adapter.getProps();\n\n    if (_isNumber(maxLength) && maxLength >= 0 && _isFunction(getValueLength) && _isString(value)) {\n      const valueLength = getValueLength(value);\n\n      if (valueLength > maxLength) {\n        // eslint-disable-next-line max-len\n        console.warn('[Semi Input] The input character is truncated because the input length exceeds the maximum length limit');\n        const truncatedValue = this.handleTruncateValue(value, maxLength);\n        return truncatedValue;\n      } else {\n        return value;\n      }\n    }\n  }\n  /**\n   * Truncate input values based on maximum length\n   * @param {String} value\n   * @param {Number} maxLength\n   * @returns {String}\n   */\n\n\n  handleTruncateValue(value, maxLength) {\n    const {\n      getValueLength\n    } = this._adapter.getProps();\n\n    if (_isFunction(getValueLength)) {\n      let truncatedValue = '';\n\n      for (let i = 1, len = value.length; i <= len; i++) {\n        const currentValue = value.slice(0, i);\n\n        if (getValueLength(currentValue) > maxLength) {\n          return truncatedValue;\n        } else {\n          truncatedValue = currentValue;\n        }\n      }\n\n      return truncatedValue;\n    } else {\n      return value.slice(0, maxLength);\n    }\n  }\n\n  handleClear(e) {\n    let eventObj = e;\n    const value = ''; // let input = this._adapter.getInput();\n\n    if (this._isControlledComponent('value')) {\n      this._adapter.setState({\n        isFocus: false\n      });\n    } else {\n      this._adapter.setState({\n        value: '',\n        isFocus: false\n      });\n    }\n\n    if (!eventObj || typeof eventObj !== 'object') {\n      eventObj = {};\n    }\n\n    _set(eventObj, strings.CLEARBTN_CLICKED_EVENT_FLAG, true); // this is useful for DateInput\n\n\n    this._adapter.notifyChange(value, eventObj);\n\n    this._adapter.notifyClear(eventObj);\n\n    if (eventObj) {\n      // When input is in popover and popover needs to judge clickOutSide, such as TreeSelect\n      // If the click event bubbles up, it will mistakenly trigger clickOutSide's judgment.\n      // At the same time, because the clear icon is not in the dom tree after clicking, and clickOutSide uses dom.contain (e.target), it will be considered as clicking on the outside, which will cause the floating layer to fold\n      // So we need to stop the incident from bubbling up\n      this.stopPropagation(eventObj);\n    }\n  }\n  /**\n   * trigger when click input wrapper\n   * @param {Event} e\n   */\n\n\n  handleClick(e) {\n    const {\n      disabled\n    } = this._adapter.getProps();\n\n    const {\n      isFocus\n    } = this._adapter.getStates();\n\n    if (disabled || isFocus) {\n      return;\n    } // do not handle bubbling up events\n\n\n    if (this._adapter.isEventTarget(e)) {\n      this._adapter.focusInput();\n\n      this._adapter.toggleFocusing(true);\n    }\n  }\n\n  handleModeChange(mode) {\n    if (mode === 'password') {\n      this._adapter.setEyeClosed(true);\n    } else {\n      this._adapter.setEyeClosed(false);\n    }\n  }\n\n  handleClickEye(e) {\n    const eyeClosed = this._adapter.getState('eyeClosed');\n\n    this._adapter.focusInput();\n\n    this._adapter.toggleFocusing(true);\n\n    this._adapter.setEyeClosed(!eyeClosed);\n  }\n\n  handleInputType(type) {\n    const mode = this._adapter.getProp('mode');\n\n    const eyeClosed = this._adapter.getState('eyeClosed');\n\n    if (mode === 'password') {\n      return eyeClosed ? 'password' : 'text';\n    }\n\n    return type;\n  }\n\n  handleMouseDown(e) {\n    e.preventDefault();\n  }\n\n  handleMouseUp(e) {\n    e.preventDefault();\n  }\n\n  handleBlur(e) {\n    const {\n      value\n    } = this.getStates();\n\n    this._adapter.toggleFocusing(false);\n\n    this._adapter.notifyBlur(value, e);\n  }\n\n  handleFocus(e) {\n    const {\n      value\n    } = this.getStates();\n\n    this._adapter.toggleFocusing(true); // this.checkAllowClear(this.getState('value'), true);\n\n\n    this._adapter.notifyFocus(value, e);\n  }\n\n  handleInput(e) {\n    this._adapter.notifyInput(e);\n  }\n\n  handleKeyDown(e) {\n    this._adapter.notifyKeyDown(e);\n  }\n\n  handleKeyUp(e) {\n    this._adapter.notifyKeyUp(e);\n  }\n\n  handleKeyPress(e) {\n    this._adapter.notifyKeyPress(e);\n\n    if (e.key === ENTER_KEY) {\n      this._adapter.notifyEnterPress(e);\n    }\n  }\n\n  isAllowClear() {\n    const {\n      value,\n      isFocus,\n      isHovering\n    } = this._adapter.getStates();\n\n    const {\n      showClear,\n      disabled\n    } = this._adapter.getProps();\n\n    const allowClear = value && showClear && !disabled && (isFocus || isHovering);\n    return allowClear;\n  }\n\n  handleClickPrefixOrSuffix(e) {\n    const {\n      disabled\n    } = this._adapter.getProps();\n\n    const {\n      isFocus\n    } = this._adapter.getStates();\n\n    if (!disabled && !isFocus) {\n      this._adapter.focusInput();\n\n      this._adapter.toggleFocusing(true);\n    }\n  }\n  /**\n   * Blocking mousedown events prevents input from losing focus\n   * @param {Event} e\n   */\n\n\n  handlePreventMouseDown(e) {\n    if (e && _isFunction(e.preventDefault)) {\n      e.preventDefault();\n    }\n  }\n  /**\n   * A11y: simulate password button click\n   */\n\n\n  handleModeEnterPress(e) {\n    // trigger by Enter or Space key\n    if (['Enter', ' '].includes(e === null || e === void 0 ? void 0 : e.key)) {\n      this.handlePreventMouseDown(e);\n      this.handleClickEye(e);\n    }\n  }\n\n}\n\nexport default InputFoundation;"],
  "mappings": "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",
  "names": ["_noop", "_isFunction", "_isNumber", "_isString", "_set", "foundation_default"]
}
