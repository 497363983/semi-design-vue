{
  "version": 3,
  "sources": ["../../../../node_modules/.pnpm/@douyinfe+semi-foundation@2.34.0/node_modules/@douyinfe/semi-foundation/lib/es/upload/utils.js"],
  "sourcesContent": ["var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nexport const byteKB = 1024;\nexport const byteMB = 1048576;\nexport function getFileSize(number) {\n  if (number < byteKB) {\n    return `${(number / byteKB).toFixed(2)}KB`;\n  } else if (number >= byteKB && number < byteMB) {\n    return `${(number / byteKB).toFixed(1)}KB`;\n  } else if (number >= byteMB) {\n    return `${(number / byteMB).toFixed(1)}MB`;\n  }\n\n  return undefined;\n}\nexport function endsWith(str, suffix) {\n  return str.indexOf(suffix, str.length - suffix.length) !== -1;\n}\nexport function loopFiles(item) {\n  return __awaiter(this, void 0, void 0, function* () {\n    return new Promise((res, rej) => {\n      const dirReader = item.createReader();\n      let fileList = [];\n\n      function sequence() {\n        dirReader.readEntries(entries => {\n          const entryList = Array.prototype.slice.apply(entries);\n          fileList = fileList.concat(entryList); // Check if all the file has been viewed\n\n          const isFinished = !entryList.length;\n\n          if (isFinished) {\n            res(fileList);\n          } else {\n            sequence();\n          }\n        }, rej);\n      }\n\n      sequence();\n    });\n  });\n}\nexport function mapFileTree(items) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const promises = [];\n\n    const _traverseFileTree = (item, path) => __awaiter(this, void 0, void 0, function* () {\n      path = path || ''; //@ts-ignore add path property into item\n\n      item.path = path;\n\n      if (item.isFile) {\n        promises.push(new Promise((res, rej) => {\n          item.file(file => {\n            if (item.fullPath && !file.webkitRelativePath) {\n              // This file is provided to the user based on the relative path of the drag and drop folder\n              // If you drag the Upload folder, the path of the internal file may be Upload/File/a.png, etc\n              Object.defineProperties(file, {\n                webkitRelativePath: {\n                  writable: true\n                }\n              }); //@ts-ignore add webkitRelativePath property into file\n\n              file.webkitRelativePath = item.fullPath.replace(/^\\//, '');\n              Object.defineProperties(file, {\n                webkitRelativePath: {\n                  writable: false\n                }\n              });\n            }\n\n            res(file);\n          }, rej);\n        }));\n      } else if (item.isDirectory) {\n        const entries = yield loopFiles(item);\n\n        for (let index = 0; index < entries.length; index++) {\n          const entry = entries[index];\n          yield _traverseFileTree(entry, `${path}${item.name}/`);\n        }\n      }\n    });\n\n    try {\n      const batches = items.map(i => _traverseFileTree(i.webkitGetAsEntry())); // Perform asynchronous operations to add the required promises to the queue\n\n      yield Promise.all(batches); // Execution queue\n\n      const result = yield Promise.all(promises);\n      return result;\n    } catch (error) {\n      console.warn('Captured error while loop directory.');\n      console.error(error);\n      return [];\n    }\n  });\n}"],
  "mappings": ";AAAA,IAAI,YAAsC,SAAU,SAAS,YAAY,GAAG,WAAW;AACrF,WAAS,MAAM,OAAO;AACpB,WAAO,iBAAiB,IAAI,QAAQ,IAAI,EAAE,SAAU,SAAS;AAC3D,cAAQ,KAAK;AAAA,IACf,CAAC;AAAA,EACH;AAEA,SAAO,KAAK,MAAM,IAAI,UAAU,SAAU,SAAS,QAAQ;AACzD,aAAS,UAAU,OAAO;AACxB,UAAI;AACF,aAAK,UAAU,KAAK,KAAK,CAAC;AAAA,MAC5B,SAAS,GAAP;AACA,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAEA,aAAS,SAAS,OAAO;AACvB,UAAI;AACF,aAAK,UAAU,OAAO,EAAE,KAAK,CAAC;AAAA,MAChC,SAAS,GAAP;AACA,eAAO,CAAC;AAAA,MACV;AAAA,IACF;AAEA,aAAS,KAAK,QAAQ;AACpB,aAAO,OAAO,QAAQ,OAAO,KAAK,IAAI,MAAM,OAAO,KAAK,EAAE,KAAK,WAAW,QAAQ;AAAA,IACpF;AAEA,UAAM,YAAY,UAAU,MAAM,SAAS,cAAc,CAAC,CAAC,GAAG,KAAK,CAAC;AAAA,EACtE,CAAC;AACH;AAEO,IAAM,SAAS;AACf,IAAM,SAAS;AACf,SAAS,YAAY,QAAQ;AAClC,MAAI,SAAS,QAAQ;AACnB,WAAO,IAAI,SAAS,QAAQ,QAAQ,CAAC;AAAA,EACvC,WAAW,UAAU,UAAU,SAAS,QAAQ;AAC9C,WAAO,IAAI,SAAS,QAAQ,QAAQ,CAAC;AAAA,EACvC,WAAW,UAAU,QAAQ;AAC3B,WAAO,IAAI,SAAS,QAAQ,QAAQ,CAAC;AAAA,EACvC;AAEA,SAAO;AACT;AACO,SAAS,SAAS,KAAK,QAAQ;AACpC,SAAO,IAAI,QAAQ,QAAQ,IAAI,SAAS,OAAO,MAAM,MAAM;AAC7D;AACO,SAAS,UAAU,MAAM;AAC9B,SAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAClD,WAAO,IAAI,QAAQ,CAAC,KAAK,QAAQ;AAC/B,YAAM,YAAY,KAAK,aAAa;AACpC,UAAI,WAAW,CAAC;AAEhB,eAAS,WAAW;AAClB,kBAAU,YAAY,aAAW;AAC/B,gBAAM,YAAY,MAAM,UAAU,MAAM,MAAM,OAAO;AACrD,qBAAW,SAAS,OAAO,SAAS;AAEpC,gBAAM,aAAa,CAAC,UAAU;AAE9B,cAAI,YAAY;AACd,gBAAI,QAAQ;AAAA,UACd,OAAO;AACL,qBAAS;AAAA,UACX;AAAA,QACF,GAAG,GAAG;AAAA,MACR;AAEA,eAAS;AAAA,IACX,CAAC;AAAA,EACH,CAAC;AACH;AACO,SAAS,YAAY,OAAO;AACjC,SAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAClD,UAAM,WAAW,CAAC;AAElB,UAAM,oBAAoB,CAAC,MAAM,SAAS,UAAU,MAAM,QAAQ,QAAQ,aAAa;AACrF,aAAO,QAAQ;AAEf,WAAK,OAAO;AAEZ,UAAI,KAAK,QAAQ;AACf,iBAAS,KAAK,IAAI,QAAQ,CAAC,KAAK,QAAQ;AACtC,eAAK,KAAK,UAAQ;AAChB,gBAAI,KAAK,YAAY,CAAC,KAAK,oBAAoB;AAG7C,qBAAO,iBAAiB,MAAM;AAAA,gBAC5B,oBAAoB;AAAA,kBAClB,UAAU;AAAA,gBACZ;AAAA,cACF,CAAC;AAED,mBAAK,qBAAqB,KAAK,SAAS,QAAQ,OAAO,EAAE;AACzD,qBAAO,iBAAiB,MAAM;AAAA,gBAC5B,oBAAoB;AAAA,kBAClB,UAAU;AAAA,gBACZ;AAAA,cACF,CAAC;AAAA,YACH;AAEA,gBAAI,IAAI;AAAA,UACV,GAAG,GAAG;AAAA,QACR,CAAC,CAAC;AAAA,MACJ,WAAW,KAAK,aAAa;AAC3B,cAAM,UAAU,MAAM,UAAU,IAAI;AAEpC,iBAAS,QAAQ,GAAG,QAAQ,QAAQ,QAAQ,SAAS;AACnD,gBAAM,QAAQ,QAAQ,KAAK;AAC3B,gBAAM,kBAAkB,OAAO,GAAG,OAAO,KAAK,OAAO;AAAA,QACvD;AAAA,MACF;AAAA,IACF,CAAC;AAED,QAAI;AACF,YAAM,UAAU,MAAM,IAAI,OAAK,kBAAkB,EAAE,iBAAiB,CAAC,CAAC;AAEtE,YAAM,QAAQ,IAAI,OAAO;AAEzB,YAAM,SAAS,MAAM,QAAQ,IAAI,QAAQ;AACzC,aAAO;AAAA,IACT,SAAS,OAAP;AACA,cAAQ,KAAK,sCAAsC;AACnD,cAAQ,MAAM,KAAK;AACnB,aAAO,CAAC;AAAA,IACV;AAAA,EACF,CAAC;AACH;",
  "names": []
}
